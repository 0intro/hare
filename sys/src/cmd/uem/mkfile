</$objtype/mkfile

TARG = \
	csrv\
	mpipefs\
	execfs\
	execcmd\
	gangfs\

HFILES = debug.h
#BIN = /$objtype/bin
BIN = /usr/$user/bin/$objtype

DIRS = tests

</sys/src/cmd/mkmany

dist:V: nuke dirsnuke
	rm *.log

dirs:V:
	p=`{pwd}
	for(i in $DIRS) @{
		cd $i
		mk $MKFLAGS all
	}
	cd $p

dirsinstall:V: install
	p=`{pwd}
	for(i in $DIRS) @{
		cd $i
		mk $MKFLAGS install
	}
	cd $p

dirsclean:V: clean
	p=`{pwd}
	for(i in $DIRS) @{
		cd $i
		mk $MKFLAGS clean
	}
	cd $p

dirsnuke:V: nuke
	p=`{pwd}
	for(i in $DIRS) @{
		cd $i
		mk $MKFLAGS nuke
	}
	cd $p

debug regress:VE: install dirsinstall
	p=`{pwd}
	for(i in $DIRS) @{
		cd $i
		mk $MKFLAGS $target
	}
	cd $p

tidy:VE:
	p=`{pwd}
	for(i in $DIRS) @{
		cd $i
		mk $MKFLAGS $target
	}
	cd $p
	rm -f /srv/mpipe
	kill execcmd | rc
	kill gangfs | rc
	kill execfs | rc
	kill mpipefs | rc
	broke | rc
	rm -f *.log
	rm -f *.acid
   	rm -rf .test
	
	unmount /proc
	bind '#p' /proc

acid:V: execfs.acid execcmd.acid mpipefs.acid gangfs.acid
